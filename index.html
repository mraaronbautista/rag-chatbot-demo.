<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dash10 Landing Page</title>
<style>
  body { margin:0; font-family: Arial, sans-serif; background: #f0f2f5; }
  header { display:flex; justify-content: space-between; align-items:center; padding: 10px 20px; background:#fff; box-shadow:0 2px 5px rgba(0,0,0,0.1);}
  header .logo { font-weight: bold; font-size: 24px; }
  header nav a { margin: 0 10px; text-decoration:none; color:#333; }
  main { text-align: center; padding: 50px 20px; background: linear-gradient(to bottom, #3a3f5c, #5c6177); color:#fff; min-height: 100vh; }
  main h1 { font-size: 48px; margin-bottom: 20px; }
  main p { font-size: 18px; margin-bottom: 30px; }
  .choose-btn { padding: 12px 24px; background: #f0c419; border:none; border-radius:5px; font-weight:bold; cursor:pointer; }

  /* Chat bubble */
  #chatBubble {
    position: fixed; bottom: 20px; right: 20px;
    background: #007bff; color: #fff; padding: 12px 18px;
    border-radius: 25px; cursor: pointer; box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    display: flex; align-items:center; gap:8px; z-index: 999;
    transition: all 0.3s ease;
  }
  #chatBubble span { font-size: 14px; }
  #chatBubble button { background: transparent; border:none; color:#fff; font-weight:bold; cursor:pointer; font-size:14px; }

  /* Circle chat icon after closing */
  #chatIcon {
    position: fixed; bottom: 20px; right: 20px;
    width: 50px; height: 50px; background:#007bff; border-radius:50%;
    display:none; justify-content:center; align-items:center; cursor:pointer; z-index:999;
  }
  #chatIcon svg { width:24px; height:24px; fill:#fff; }

  /* Chat widget */
  /* Chat widget */
  #chatWidget {
    position: fixed;
    bottom: 80px;
    right: 20px;
    width: 350px;
    max-height: 600px; /* taller */
    height: 500px;     /* initial height */
    background: #fff;
    border-radius: 15px;
    box-shadow: 0 8px 20px rgba(0,0,0,0.2);
    display: flex;
    flex-direction: column;
    overflow: hidden;
    display: none;
    z-index: 1000;
    transition: height 0.3s ease; /* smooth opening */
  }
  .chat-header { background:#007bff; color:#fff; text-align:center; padding:12px; font-weight:bold; }
  .chat-box { flex:1; padding:12px; overflow-y:auto; display:flex; flex-direction:column; gap:8px; background:#f9f9f9; }
  .message { padding:8px 12px; border-radius:15px; max-width:80%; word-wrap:break-word; }
  .user-msg { background:#007bff; color:#fff; align-self:flex-end; }
  .bot-msg { background:#e5e5ea; color:#000; align-self:flex-start; }
  .input-container { display:flex; border-top:1px solid #ddd; }
  #userInput { flex:1; padding:8px 12px; border:none; font-size:14px; }
  #userInput:focus { outline:none; }
  #sendButton { padding:0 12px; border:none; background:#007bff; color:#fff; cursor:pointer; }
  #sendButton:disabled { background:#aaa; cursor:not-allowed; }
  .loader::after { content:''; display:inline-block; width:5px; height:5px; margin:0 2px; background:#999; border-radius:50%; animation: blink 1s infinite; }
  @keyframes blink { 0%,80%,100% {opacity:0;} 40% {opacity:1;} }
</style>
</head>
<body>

<header>
  <div class="logo">Dash10</div>
  <nav>
    <a href="#">Home</a>
    <a href="#">Our Story</a>
    <a href="#">Our Mission</a>
    <a href="#">Career Opportunities</a>
    <a href="#">Team</a>
    <a href="#">Contact</a>
  </nav>
</header>

<main>
  <h1>Dash to Your Dream Career</h1>
  <p>Be part of the Dash10 family and build a career in Digital Marketing and Web Design in a fun and dynamic work environment.</p>
  <button class="choose-btn">CHOOSE YOUR PATH</button>
</main>

<!-- Chat bubble -->
<div id="chatBubble">
  <span>Click me if you need help!</span>
  <button id="closeBubble">X</button>
</div>

<!-- Chat circle icon -->
<div id="chatIcon">
  <svg viewBox="0 0 24 24"><path d="M12 3C7.03 3 3 6.58 3 11c0 2.03.77 3.89 2.05 5.39L3 21l4.61-2.06C9.11 19.23 10.95 20 13 20c4.97 0 9-3.58 9-8s-4.03-8-9-8zm-1 11h-2v-2h2v2zm4 0h-2v-2h2v2z"/></svg>
</div>

<!-- Chat widget -->
<div id="chatWidget">
  <div class="chat-header">Maddie - TechHub Assistant</div>
  <div class="chat-box" id="chatBox"></div>
  <div class="input-container">
    <input type="text" id="userInput" placeholder="Type your question..." />
    <button id="sendButton">Send</button>
  </div>
</div>

<script>
const chatBubble = document.getElementById("chatBubble");
const chatIcon = document.getElementById("chatIcon");
const closeBubble = document.getElementById("closeBubble");
const chatWidget = document.getElementById("chatWidget");
const chatBox = document.getElementById("chatBox");
const userInput = document.getElementById("userInput");
const sendButton = document.getElementById("sendButton");

const WEBHOOK_URL = "https://n8n.metroaisolutions.com/webhook/26c6631f-cd2e-4412-a2e3-3ffd4ec08426";

// Open chat widget from bubble
chatBubble.addEventListener("click", () => {
  chatWidget.style.display = "flex";
  chatBubble.style.display = "none";
  userInput.focus();
});

// Close bubble and show chat icon
closeBubble.addEventListener("click", (e) => {
  e.stopPropagation();
  chatBubble.style.display = "none";
  chatIcon.style.display = "flex";
});

// Click chat icon to reopen widget
chatIcon.addEventListener("click", () => {
  chatWidget.style.display = "flex";
  chatIcon.style.display = "none";
  userInput.focus();
});

// Auto-hide initial bubble after 5s
setTimeout(() => {
  chatBubble.style.opacity = "0";
  setTimeout(() => chatBubble.style.display = "none", 300);
  chatIcon.style.display = "flex";
}, 5000);

// Messaging functions
function appendMessage(text, sender) {
  const div = document.createElement("div");
  div.classList.add("message", sender === "user" ? "user-msg" : "bot-msg");
  div.textContent = text;
  chatBox.appendChild(div);
  chatBox.scrollTop = chatBox.scrollHeight;
  return div;
}

function createLoader() {
  const div = document.createElement("div");
  div.classList.add("message", "bot-msg", "loader");
  div.textContent = "...";
  chatBox.appendChild(div);
  chatBox.scrollTop = chatBox.scrollHeight;
  return div;
}

async function sendMessage() {
  const question = userInput.value.trim();
  if (!question) return;

  appendMessage(question, "user");
  userInput.value = "";
  sendButton.disabled = true;

  const loadingMsg = createLoader();

  try {
    const res = await fetch(WEBHOOK_URL, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ question })
    });
    const data = await res.json();
    loadingMsg.remove();

    const sentences = data.reply.split(/(?<=\.)\s/).filter(Boolean);
    sentences.forEach((sentence, index) => {
      setTimeout(() => appendMessage(sentence, "bot"), index * 600);
    });

  } catch (err) {
    loadingMsg.textContent = "Error connecting to bot.";
    loadingMsg.classList.remove("loader");
    console.error(err);
  } finally {
    sendButton.disabled = false;
    userInput.focus();
  }
}

sendButton.addEventListener("click", sendMessage);
userInput.addEventListener("keydown", (e) => {
  if (e.key === "Enter") { e.preventDefault(); sendMessage(); }
});
</script>

</body>
</html>
